/*
               KSV Editor
    Copyright: (C) 2000-2003 Serguey Klimoff (bulkl0DD)
     Filename: U:\GUVA\TITUL\TITUL.DEF
      Comment: <comment>
   Parameters:
         Uses:
      Used by:
      Created: 21.08.2012 12:55 gva     
     Modified: 21.08.2012 14:17 gva      
     Modified: 22.08.2012 09:56 gva      
     Modified: 22.08.2012 10:11 gva      
     Modified: 22.08.2012 10:11 gva      
     Modified: 22.08.2012 15:24 gva      
     Modified: 23.08.2012 12:28 gva      
     Modified: 23.08.2012 12:41 gva      
     Modified: 23.08.2012 12:43 gva      
     Modified: 24.08.2012 14:32 gva      
     Modified: 24.08.2012 14:42 gva      
     Modified: 24.08.2012 14:58 gva      
     Modified: 27.08.2012 14:24 gva      
     Modified: 27.08.2012 15:50 gva      
     Modified: 27.08.2012 15:38 gva      
     Modified: 27.08.2012 15:53 gva      
     Modified: 27.08.2012 16:05 gva      
     Modified: 28.08.2012 16:17 gva      
     Modified: 27.08.2012 17:26 gva      
     Modified: 24.01.2014 KAU для печати отдельно сотрудников головы
     Modified: 
*/
DEFINE VARIABLE mKas-b LIKE op-entry.amt-rub INIT 0.00 NO-UNDO.
DEFINE VARIABLE mKas-o LIKE op-entry.amt-rub INIT 0.00 NO-UNDO.
DEFINE VARIABLE mBuh-b LIKE op-entry.amt-rub INIT 0.00 NO-UNDO.
DEFINE VARIABLE mBuh-o LIKE op-entry.amt-rub INIT 0.00 NO-UNDO.
DEFINE VARIABLE mBuh-val-b LIKE op-entry.amt-rub INIT 0.00 NO-UNDO.
DEFINE VARIABLE mBuh-val-o LIKE op-entry.amt-rub INIT 0.00 NO-UNDO.
DEFINE VARIABLE mKas-val-b LIKE op-entry.amt-rub INIT 0.00 NO-UNDO.
DEFINE VARIABLE mKas-val-o LIKE op-entry.amt-rub INIT 0.00 NO-UNDO.
DEFINE VARIABLE mBuh-el-b LIKE op-entry.amt-rub INIT 0.00 NO-UNDO.
DEFINE VARIABLE mBuh-el-o LIKE op-entry.amt-rub INIT 0.00 NO-UNDO.
DEFINE VARIABLE mKas-el-b LIKE op-entry.amt-rub INIT 0.00 NO-UNDO.
DEFINE VARIABLE mKas-el-o LIKE op-entry.amt-rub INIT 0.00 NO-UNDO.


DEFINE TEMP-TABLE tt-op-day NO-UNDO
    FIELD op-cid AS RECID
    FIELD ope-cid AS RECID
    FIELD city-id AS INTEGER
    FIELD city AS CHARACTER
    FIELD kko AS CHARACTER
    FIELD currency LIKE op-entry.currency
    FIELD acct-cat LIKE op-entry.acct-cat
    FIELD razdel AS CHARACTER
    FIELD save-type AS CHARACTER
    FIELD acct-db LIKE op-entry.acct-db
    FIELD acct-cr LIKE op-entry.acct-cr
    FIELD doc-num LIKE op.doc-num
    FIELD amt-rub LIKE op-entry.amt-rub
    FIELD user-id like op.user-id
    FIELD op 		LIKE op.op
    FIELD op-kind 	LIKE op.op-kind
    FIELD doc-date	LIKE op.doc-date
    INDEX op-day op-cid ope-cid city kko razdel.

DEFINE TEMP-TABLE tt-day-itog NO-UNDO
    FIELD city-id AS INTEGER
    FIELD city AS CHARACTER
    FIELD kko AS CHARACTER
    FIELD currency LIKE op-entry.currency
    FIELD acct-cat LIKE op-entry.acct-cat
    FIELD razdel AS CHARACTER
    FIELD save-type AS CHARACTER
    FIELD itog LIKE op-entry.amt-rub
    INDEX day-itog city kko razdel.

DEFINE TEMP-TABLE tt-kko
    FIELD city-id AS INTEGER
    FIELD city AS CHARACTER
    FIELD kko AS CHARACTER
INDEX prr city-id kko.

FUNCTION GetDateString RETURN CHARACTER PRIVATE(INPUT iDate AS DATE):
    IF iDate = ? THEN
        RETURN ?.
        RETURN ("``" + STRING(DAY(iDate)) + "\'\' " + ENTRY(MONTH(iDate), "января,февраля,марта,апреля,мая,июня,июля,августа,сентября,октября,ноября,декабря") + " " + STRING(YEAR(iDate)) + " г.").
END FUNCTION.




/*--------------------------------*/
/*FUNCTION GetRazdel RETURNS DECIMAL
   (
    ipOp-cid  AS RECID,
    ipOpe-cid  AS RECID
    ):
    DEFINE VARIABLE opRazdel AS CHARACTER NO-UNDO.
    DEFINE VARIABLE  AS LOGICAL    NO-UNDO.
    DEFINE VARIABLE adb       AS CHARACTER NO-UNDO.
    DEFINE VARIABLE acr       AS CHARACTER NO-UNDO.

    FIND FIRST op WHERE RECID(op) EQ ipOp-cid
         NO-LOCK NO-ERROR.
    FIND FIRST op-entry WHERE RECID(op-entry) EQ ipOpe-cid
         NO-LOCK NO-ERROR.
    /* 1. Определяем документ по назначению */
    isCash = TRIM(BuxJour.Contract) NE "" 
             AND 
             (   CAN-FIND (FIRST acct WHERE acct.acct EQ adb AND CAN-DO(BuxJour.Contract,acct.contract) NO-LOCK)
              OR CAN-FIND (FIRST acct WHERE acct.acct EQ acr AND CAN-DO(BuxJour.Contract,acct.contract) NO-LOCK)
             ).



   RETURN opRazdel.
END FUNCTION. /* GetRazdel */
*/
