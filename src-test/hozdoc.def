/* классификатор ХозДок */
DEF TEMP-TABLE hozdoc NO-UNDO
	FIELD type      AS CHAR
	FIELD doctype   AS CHAR
	FIELD acct-cr   AS CHAR
	FIELD acct-db   AS CHAR
	FIELD details   AS CHAR
	FIELD branch-cr AS CHAR
	FIELD branch-db AS CHAR
.
DEF VAR iTemp  AS CHAR NO-UNDO. /* для can-do */
DEF VAR isHoz  AS LOG  NO-UNDO.

&IF DEFINED(AcBuf)=0 &THEN
	
	&GLOBAL-DEFINE AcBuf

	DEF BUFFER b-acctcr FOR acct.
	DEF BUFFER b-acctdb FOR acct.
	DEF BUFFER b-ope    FOR op-entry.

	DEF VAR vACR AS CHAR NO-UNDO. /* для сохранения op-entry.acct-cr */
	DEF VAR vADB AS CHAR NO-UNDO. /* для сохранения op-entry.acct-db */

&ENDIF

/* code -> hozdoc */
FOR EACH code WHERE code.class EQ 'ХозДок' 
			  AND   code.parent EQ 'ХозДок'
			  /* проверка на даты */
			  AND   DATE(code.misc[6]) LE end-date
			  AND  (DATE(code.misc[7]) GE end-date
			  OR    DATE(code.misc[7]) EQ ?)
	NO-LOCK:

	CREATE hozdoc.
	ASSIGN
		hozdoc.type      = code.name
		hozdoc.doctype   = code.val
		hozdoc.acct-cr   = code.misc[1]
		hozdoc.acct-db   = code.misc[2]
		hozdoc.details   = code.misc[3]
		hozdoc.branch-cr = code.misc[4]
		hozdoc.branch-db = code.misc[5]
	.	

END.