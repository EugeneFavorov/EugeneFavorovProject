/* Номер договора */
IF FRAME-FIELD EQ "mDocRef"
THEN DO:
   rid_loan = RECID({&FILE}).
   RUN formld.p ({&FILE}.class-code,
                 {&FILE}.contract + "," + {&FILE}.cont-code,
                 "",
                 {&MOD_VIEW},
                 level + 1).
END.
/* Номер счета */
ELSE IF FRAME-FIELD EQ 'cacct' AND
        cacct NE "" AND
        cacct NE ? 
    THEN  RUN formld.p ("acct",
                        AddFilToAcct(REPLACE(cacct, "-", ""),ShFilial) + "," + loan.currency,
                        "",
                        {&MOD_VIEW},
                        level + 1).


/* Код валюты */
ELSE IF FRAME-FIELD EQ 'currency' THEN
    RUN currenc#.p (loan.currency, 5).

/* Клиент */
ELSE IF FRAME-FIELD EQ 'name-klient' or 
    FRAME-FIELD EQ 'cust-id'         or
    FRAME-FIELD EQ 'unk-klient'
THEN DO:
    IF loan.cust-cat EQ 'Ю' THEN
        RUN formld.p ("cust-corp",
                      STRING(loan.cust-id),
                      "",
                      {&MOD_VIEW},
                      level + 1).
    ELSE IF loan.cust-cat EQ 'Ч' THEN
       RUN formld.p ("person",
                      STRING(loan.cust-id),
                      "",
                      {&MOD_VIEW},
                      level + 1).
    ELSE IF loan.cust-cat EQ 'Б' THEN
       RUN formld.p ("banks",
                      STRING(loan.cust-id),
                      "",
                      {&MOD_VIEW},
                      level + 1).
END.
/* Класс объекта */
ELSE IF FRAME-FIELD EQ 'class-code' THEN DO:
    FIND FIRST class WHERE class.class-code EQ loan.class-code
                   NO-LOCK NO-ERROR.
    IF AVAIL class THEN
    ASSIGN
        msg      = class.name
        sh_title = class.class-code.
    ELSE
    ASSIGN 
        msg      = 'Данный класс не найден!'
        sh_title = 'ОШИБКА'.
    DISPLAY msg FORMAT "x(23)"
    WITH FRAME hlp OVERLAY TOP-ONLY 1 COL ROW level + 1 
    NO-LABEL CENTERED TITLE '[ ' + sh_title + ' ]'.
    PAUSE.
    CLEAR FRAME NAME NO-PAUSE.
END.
ELSE IF FRAME-FIELD EQ "loan-status"
THEN RUN shifr.p ("loan-status", loan.loan-status,level + 1).
   
