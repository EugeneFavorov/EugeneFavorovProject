/* Заполняем врем таблицу с проводками по */
{empty ttSafeType}
FOR EACH datablock
	WHERE datablock.dataclass-id EQ "safetyp"
	AND datablock.branch-id EQ mFilial
	AND datablock.beg-date EQ end-date
	AND datablock.end-date EQ end-date
	NO-LOCK, EACH dataline
	WHERE dataline.data-id EQ datablock.data-id
		AND dataline.val[4] EQ 2.0
	NO-LOCK
	BY dataline.sym1 + dataline.txt:
		CREATE ttSafeType.
		ASSIGN
			ttSafeType.bal-acct = IF TRIM(dataline.txt) EQ "C" AND dataline.sym1 BEGINS "9" AND NOT (dataline.sym2 BEGINS "9999") THEN dataline.sym2 ELSE dataline.sym1
			ttSafeType.dbcr = IF TRIM(dataline.txt) EQ "C" AND dataline.sym1 BEGINS "9" AND NOT (dataline.sym2 BEGINS "9999") THEN "C" ELSE "D"
			ttSafeType.op-entry-id = INT64(dataline.val[1])
			ttSafeType.dbcr-sort = IF TRIM(dataline.txt) EQ "C" AND dataline.sym1 BEGINS "9" AND NOT (dataline.sym2 BEGINS "9999") THEN "2" ELSE "1"
			.
END.
