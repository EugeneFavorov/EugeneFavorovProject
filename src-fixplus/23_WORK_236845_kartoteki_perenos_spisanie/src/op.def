/*
               Банковская интегрированная система БИСквит
    Copyright: (C) 1992-2005 ТОО "Банковские информационные системы"
     Filename: OP.DEF
      Comment: (0046989) Добавлены константы,
               связанные с новой системой валидации
   Parameters:
         Uses:
      Used by:
     Modified: 19.09.2005 19:15 KSV      (0046989) Добавлены константы,
                                         связанные с новой системой валидации
     Modified: 19.09.2005 21:42 KSV      (0046989) Добавлено подключение
                                         интерфейсов valid и strng.
     Modified: 10.10.2006 14:02 DEMA     (0069051) Проверка красного сальдо при
                                         ежедневной загрузки данных
     Modified: 06.06.2008 MUTA 0088417   Функция Chksgnopint                                         
*/
/****************************************************************
 * Дополнительные параметры для валидатора документа и проводки *
 ***************************************************************/
/* Commented by KSV: Выключает валютный контроль  */
&GLOBAL-DEFINE VP_VO_CONTROL     "OP_VO_CONTROL"
/* Commented by KSV: Выключает проверку на террористов */
&GLOBAL-DEFINE VP_TERR_CHECK     "OP_TERR_CHECK"
/* Commented by KSV: Для процедуры ERR-EVENT передает хэндл на буфер ACCT */
&GLOBAL-DEFINE VP_ACCT_HANDLE    "OE_ACCT_HANDLE"
/* Commented by KSV: Значение для передачи в метод CHKUPD */
&GLOBAL-DEFINE VP_EXT_PARAM      "OP_EXT_PARAM_"
/* Commented by KSV: Выключает расширенную проверку проводки, существенно
** повышает скорость работы  */
&GLOBAL-DEFINE VP_EXT_CHECK      "OE_EXT_CHECK"
/* Dema: Полностью отключает проверку остатка по счетам, ускоряет проверку */
&GLOBAL-DEFINE VP_POS_CHECK      "OE_POS_CHECK"
/* Выключаем проверку корреспонденции счетов */
&GLOBAL-DEFINE VP_CORRACCT_CONTROL "OP_CORRACCT_CONTROL"

&IF DEFINED(DEFHANDLEINTRFACE_OP) &THEN
/* Склеивает номер счета и код валюты для вывода сообщений,
   входные параметры - номер счета, код валюты счета */

FUNCTION ClueAcctCurr      RETURN CHAR    (INPUT in-acct       AS CHAR,
                                           INPUT in-curr       AS CHAR)      IN {1}.

/* определяет лимит остатка на расчетном счете по данным договора о
   расчетно-кассовом обслуживании
   входные параметры - буффер счета, дата, на которую делается поиск */

FUNCTION GetLimitPosition  RETURN decimal (BUFFER b-acct       FOR acct,
                                           INPUT  in-op-date   AS  DATE)     IN {1}.

/* Определяет неиспользованный лимит овердрафта    */
FUNCTION GetOverLimit  RETURN decimal (BUFFER b-acct       FOR acct,
                                       INPUT  in-op-date   AS  DATE)     IN {1}.

/*Документ является сводным*/
FUNCTION OpIsSvod          RETURN LOG     (INPUT  ipRecOp      AS RECID) IN {1}.

/* Проверить ограничение расчетов банка */
FUNCTION CheckBankReal     RETURN CHAR    (BUFFER chk-bank    FOR banks) IN {1}.

/* возвращает номер первой попавшейся операции из того же дерева транзакции */
FUNCTION fGetTrnFirstOp RETURNS INT64   (INPUT iOp AS INT64) IN {1}.

/* Проверяет, есть ли ссылки на документ в доп. реквизитах ДокОтр47423 или ДокОпл47423 */
FUNCTION Chksgnopint RETURNS LOGICAL (INPUT iOp AS INT64) IN {1}. 

/* Проверяет, является ли документ конверсионным? Если является возвращает
   дебетуемый и кредитуемый счета конверсионной операции, их суммы и валюты
*/
FUNCTION IsOpConv RETURNS LOGICAL (INPUT  iOp     AS INT64,
                                   OUTPUT oAcctDb AS CHARACTER,
                                   OUTPUT oCurrDb AS CHARACTER,
                                   OUTPUT oAmtDb  AS DECIMAL,    
                                   OUTPUT oAcctCr AS CHARACTER,
                                   OUTPUT oCurrCr AS CHARACTER,
                                   OUTPUT oAmtCr  AS DECIMAL) IN {1}. 

FUNCTION CountDocNum RETURNS CHARACTER (INPUT iDefCount AS INT64, 
                                        INPUT iDefValue AS CHARACTER,
                                        INPUT iDateOp   AS DATE) IN {1}.

FUNCTION cashCBCodeType RETURN CHARACTER (INPUT isDb AS LOGICAL) IN {1}.

RUN GetLogParam IN {1}.
{intrface.get valid}
{intrface.get strng}
&ENDIF 
